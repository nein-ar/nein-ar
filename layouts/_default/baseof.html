<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode | default "en-us" }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }} // {{ .Site.Title }}</title>
    <link rel="icon" type="image/png" href="{{ .Site.Params.favicon | default "https://github.com/nein-ar.png" }}">
    
    <!-- TAILWIND & FONTS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="{{ "css/quixotist.css" | absURL }}" rel="stylesheet">
    
    <!-- WERX LOGIC INJECTION -->
    <link href='{{ "/css/SerenityOS-Emoji.css" | absURL }}' rel="stylesheet" type="text/css">
    <link href='{{ "/css/highlightjs_style.css" | absURL }}' rel="stylesheet" type="text/css">
    <script id="MathJax-script" async src="{{ "/js/tex-mml-chtml.js" | absURL }}"></script>
    <script async src="{{ "/js/highlight.min.js" | absURL }}"></script>
    <script async src="{{ "/js/highlight-basic.min.js" | absURL }}"></script>
    <script async src="{{ "/js/highlight-bash.min.js" | absURL }}"></script>
    <script async src="{{ "/js/highlight-go.min.js" | absURL }}"></script>
    <script async src="{{ "/js/highlight-c.min.js" | absURL }}"></script>

    <!-- MERMAID SUPPORT -->
    {{ if or (.HasShortcode "mermaid") (.Store.Get "hasMermaid") }}
      <link rel="stylesheet" href="{{ "css/mermaid.css" | absURL }}">
      <script async type="application/javascript" src='{{ "/js/mermaid.min.js" | absURL }}'>
        mermaid.initialize({ startOnLoad: true });
      </script>
    {{ end }}
    
    <!-- CHARTJS SUPPORT -->
    {{ if or (.HasShortcode "chart") (.Store.Get "hasChart") }}
      <script type="application/javascript" src='{{ "/js/chart.min.js" | absURL }}'></script>
    {{ end }}
    
    <!-- D3JS SUPPORT -->
    {{ if or (.HasShortcode "d3js") (.Store.Get "hasD3JS") }}
      <script type="application/javascript" src='{{ "/js/d3.min.js" | absURL }}'></script>
      <script type="application/javascript" src='{{ "/js/topojson.min.js" | absURL }}'></script>
    {{ end }}

    <style>
        header nav, body > nav, footer.no-print { display: none !important; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="scanline"></div>

    <div class="max-w-6xl mx-auto">
        <!-- Header Section -->
        <header class="flex flex-col md:flex-row items-center gap-6 mb-8">
            <div class="bunker-window p-2 mb-0">
                <img src="{{ .Site.Params.avatar | default "https://github.com/nein-ar.png" }}" alt="avatar" class="w-32 h-32 md:w-40 md:h-40 border-2 border-black image-pixelated">
            </div>
            <div class="text-center md:text-left">
                <h1 class="text-4xl md:text-6xl font-bold tracking-tighter uppercase mb-2"><a href="{{ .Site.BaseURL }}">{{ .Site.Title }}</a></h1>
                <p class="text-sm bg-black text-white px-2 py-1 inline-block">{{ .Site.Params.subtitle }}</p>
                <div class="mt-4 flex gap-2 justify-center md:justify-start">
                    {{ range .Site.Params.header_tags }}
                        {{ if eq .style "highlight" }}
                            <span class="text-xs border border-black px-2 font-bold bg-[#ffcc00] text-black">{{ .text }}</span>
                        {{ else }}
                            <span class="text-xs border border-black px-2">{{ .text }}</span>
                        {{ end }}
                    {{ end }}
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
            
            <!-- Left Column: Dynamic Widgets -->
            <div class="md:col-span-3">
                {{ range .Site.Params.widgets.left }}
                    <div class="bunker-window {{ if eq .type "hero" }}text-center{{ end }}">
                        {{ if .title }}
                        <div class="window-title">
                            <span>{{ .title }}</span>
                            {{ if .title_right }}<span>{{ .title_right }}</span>{{ end }}
                        </div>
                        {{ end }}

                        <!-- Widget: Menu -->
                        {{ if eq .type "menu" }}
                            {{ range $.Site.Menus.main }}
                            <a href="{{ .URL }}" class="nav-link">~/{{ .Name | lower }}</a>
                            {{ end }}
                        {{ end }}

                        <!-- Widget: Status -->
                        {{ if eq .type "status" }}
                            <div class="text-xs space-y-2">
                                {{ range .rows }}
                                <p><strong>{{ .key }}:</strong> {{ .value }}</p>
                                {{ end }}
                                {{ if .quote }}
                                <div class="accent-bar mt-2"></div>
                                <p class="italic text-[10px]">{{ .quote | safeHTML }}</p>
                                {{ end }}
                            </div>
                        {{ end }}

                        <!-- Widget: Hero -->
                        {{ if eq .type "hero" }}
                            <span class="text-4xl">{{ .icon }}</span>
                            <p class="text-[10px] mt-2 font-bold uppercase">{{ .text }}</p>
                        {{ end }}
                    </div>
                {{ end }}
            </div>

            <!-- Main Column: Content -->
            <div class="md:col-span-6">
                {{ block "main" . }}{{ end }}
            </div>

            <!-- Right Column: Dynamic Widgets -->
            <div class="md:col-span-3">
                {{ range .Site.Params.widgets.right }}
                    
                    {{ if eq .type "flag" }}
                         <div class="flex flex-col gap-1 opacity-50 mb-6">
                            {{ $symbol := .symbol }}
                            {{ range $index, $color := .colors }}
                                {{ if eq $index 1 }}
                                    <div class="h-2 flex justify-center items-center" style="background-color: {{ $color }}">
                                        {{ if $symbol }}<span class="text-[6px]">{{ $symbol }}</span>{{ end }}
                                    </div>
                                {{ else }}
                                    <div class="h-2" style="background-color: {{ $color }}"></div>
                                {{ end }}
                            {{ end }}
                        </div>
                    {{ else }}
                        <div class="bunker-window" id="{{ .title | urlize }}">
                            {{ if .title }}
                            <div class="window-title">
                                <span>{{ .title }}</span>
                                {{ if .title_right }}<span>{{ .title_right }}</span>{{ end }}
                            </div>
                            {{ end }}

                            <!-- Widget: Buttons -->
                            {{ if eq .type "buttons" }}
                                <div class="flex flex-wrap justify-center gap-1">
                                    {{ range .items }}
                                    <a href="{{ .url | default "#" }}" class="btn-88x31 {{ .class }}" {{ if .alt }}title="{{ .alt }}"{{ end }}>{{ .name }}</a>
                                    {{ end }}
                                </div>
                            {{ end }}

                            <!-- Widget: Links -->
                            {{ if eq .type "links" }}
                                <ul class="text-[10px] space-y-2">
                                    {{ range .items }}
                                    <li>â€¢ <a href="{{ .url }}" class="underline">{{ .name }}</a> {{ .note }}</li>
                                    {{ end }}
                                </ul>
                            {{ end }}
                        </div>
                    {{ end }}

                {{ end }}
            </div>
        </div>

        <!-- Footer Marquee -->
        <footer class="mt-8">
            <div class="marquee border-2 border-black">
                <div class="marquee-content">
                    {{ .Site.Params.marquee.text }} {{ .Site.Params.marquee.text }}
                </div>
            </div>
            <div class="text-[8px] mt-2 text-center uppercase tracking-widest">
                All rights reserved to the individual. Proudly released into the Public Domain or licensed under the ISC 
            </div>
        </footer>
    </div>
</body>
</html>
